<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    .result {
      font-size: 20px;
      margin-top: 20px;

    }


    .totalGrade {
      padding-left: 30px;

      display: none;
      animation: 03s fadeIn;
    }

    .totalGradeDisplay {
      display: block;
    }

    .totalGradeNoDisplay {
      display: none;
    }

    #totalSeitouritsu {
      font-size: 24px;
    }

    #totalComment {
      font-size: 24px;
      color: red;
    }

    @keyframes fadeIn {
      0% {
        opacity: 0;
        transform: translateY(-10px);

      }

      100% {
        opacity: 1;
        transform: none;
      }

    }
  </style>
</head>

<body>
  <h3>中国語　フラッシュカード</h3>
  <img id="flashcard-image" width="300" height="300">
  
  <form class="formDisplay formDisplayNone">
    <input id="answer" type="text">
    <button id="chkInput">check</button>
    <p id="comment"></p>
  </form>
  <div id="result" class="result resultNone">正解: 0 回 不正解: 0 回</div>
  <div class="totalGrade totalGradeNoDisplay">
    <p id="totalSeitouritsu"></p>
    <p id="totalComment"></p>

  </div>
  <script>
    // 仮のフラッシュカードデータ
    let flashcards = [
      { image: 'images/yabo.jpg', word: '鸭脖' },
      { image: 'images/beergarden.jpg', word: '啤酒花园' },
      // 他のフラッシュカードを追加...
    ];
    const synth = window.speechSynthesis;
    let currentIndex = 0;
    let correctCount = 0;
    let incorrectCount = 0;
    const totalGrade = document.querySelector('.totalGrade');
    // 初期化
    let button = document.getElementById('chkInput');
    button.addEventListener('click', checkAnswer);
    showFlashcard();

    // フラッシュカードを表示する関数
    function showFlashcard() {
      let flashcard = flashcards[currentIndex];
      let imgElement = document.getElementById('flashcard-image');
      let comment = document.getElementById('comment');

      // 画像と結果をリセット
      imgElement.src = flashcard.image;
      comment.textContent = '';
    }

    // ユーザーの回答をチェックする関数
    function checkAnswer(e) {
      e.preventDefault();
      let flashcard = flashcards[currentIndex];
      let answerElement = document.getElementById('answer');
      let comment = document.getElementById('comment');
      if (button.textContent === 'check') {
        button.textContent = 'next';
        // 回答が正しいかどうかをチェック
        if (flashcard.word === answerElement.value) {
          comment.textContent = '好！赞👍';
          speakText2(comment.textContent);
          console.log('seikai')
          correctCount++;
        } else {
          comment.textContent = `错×　再加油！！ ${flashcard.word}`;
          speakText2(comment.textContent);
          console.log('fuseikai');
          incorrectCount++;
        }


        displayResult();

      } else {

        // 次のフラッシュカードに進む
        currentIndex++;
        if (currentIndex === flashcards.length) {
        
          totalGrade.classList.add('totalGradeDisplay');
          totalGrade.classList.remove('totalGradeNoDisplay');
          let totalSeitouritsu = document.getElementById('totalSeitouritsu');
          let totalComment = document.getElementById('totalComment');
          let mondaisu = flashcards.length;
          let ritsu = correctCount * 100 / mondaisu;
          totalSeitouritsu.textContent = `正答数は${correctCount}, 正答率は${ritsu.toFixed(1)}でした。`;
          if (correctCount === mondaisu) {

            totalComment.textContent = '恭喜恭喜!!';
            
            speakText2('恭喜恭喜!!');
          } else {
            totalComment.textContent = '';

          }
        


        } else {
          button.textContent = 'check';
          answerElement.value = '';
          showFlashcard();

        }
      
      }

    }
    // テキストを音声に変換して再生する関数
    function speakText2(text) {

      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'zh-CN'; // 中国語の言語コード
      synth.speak(utterance);
    }
     // 結果を表示する関数
     function displayResult() {
      result.textContent = `正解: ${correctCount} 回 不正解: ${incorrectCount} 回`;
    }




  </script>

</body>

</html>